%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% NAME:             designdoc.tex
%
% AUTHOR:           Ethan D. Twardy <edtwardy@mtu.edu>
%
% DESCRIPTION:      Design Document for the project.
%
% CREATED:          05/15/2019
%
% LAST EDITED:      08/09/2019
%%%

\documentclass{designdoc}

\begin{document}
\section{Introduction}
\textit{SortMedia} is a program used to enumerate and restructure a Music
library. Taking as an argument the path of a directory to organize as a music
library, the application recursively searches the directory for media files,
parsing each one for its metadata, then organizing the files into a
(potentially) new directory structure according to some basic rules.

The needs of this kind of program have a tendency to change frequently, so the
goal of this design is to be as versatile as possible.

\hypertarget{sec:axesOfChange}{\section{Axes of Change}}
An \textit{Axis of Change} for software is a reason for the code to undergo
some change as a result of a requirements change. It's often useful to predict
the axes of change that a project has before beginning its design. The
SortMedia project will be designed with the following axes of change in mind:

\subsection{Adding New Organizational Schemas}
An Organizational Schema is a set of rules that dictate the organization of
media files on the filesystem, as well as the metadata that they contain. The
schema that I prefer has changed slightly over the years, and is likely to
change again.

\subsection{Adding New Media File Types}
There are many types of media files. It's not reasonable to support all of them
from the beginning. The design shall make it easy to incorporate new media file
types into the project.

\subsection{Adding New File Operations to an Organizational Schema}
Separate from the organizational schema are the file operations. These are
rules that dictate how a change is performed to a file. With new Organizational
Schemas naturally comes the need for new File Operations.

\subsection{Exposing Greater Amounts of Configuration via the Command Line
  Interface}
Due to the nature of the design, as more child classes become available for
performing new or different functions per the axes of change outlined above,
the command line interface will also allow expansion to expose greater amounts
of configuration to the user. This will be accomplished in part via the
abundance of Factor Pattern methods in the design. These methods may be moved
to their own class, which can each then be probed and extended to determine its
functionality during the verification of runtime arguments, and also to provide
helpful messages to the user. There will also be a high degree of segregation
between the classes whose responsibility includes the command line interface
itself and those that use the arguments provided thereby, achieved using the
methods explained previously and creative use of the Dependency Injection
idiom.

\section{Software Requirements}
This section outlines the requirements of the software. From this point
forward, \emph{the Software} shall refer to the software product contained
herein.

\swrequirement{Name}
The executable binary program generated by the Software shall be named
\texttt{SortMedia}.

\swrequirement{Basic Usage}
The usage of the software is given below:

\begin{verbatim}
Usage: SortMedia -librarytype:<libraryType> <rootDirectoryOfLibrary>
\end{verbatim}

Where \texttt{libraryType} is one of: \texttt{music,movie,serial,audiobook} and
\texttt{rootDirectoryOfLibrary} is the root directory of the music library on
the filesystem.

\swrequirement{Repository Design Pattern}
The Software shall use a Repository design pattern for organizing Media files.
This has a number of benefits:
\begin{enumerate}
\item Changes to Media Files can be performed in atomic operations.
\item Changes to Media Files can be reverted in the case of a
  \textit{Non-Fatal Error}.
\end{enumerate}

\swrequirement{Runtime Phases}
On every invocation, the Software shall perform its logic in two phases:
\begin{enumerate}
\item \textit{Initialization}: The Software enumerates the library to determine
  a list of files and that the library is a good candidate for
  \textit{Organization}.
\item \textit{Organization}: The Software shall apply rules to organize the
  media files in the library.
\end{enumerate}

\swrequirement{Initialization}
On initialization, the Software shall enumerate the library to determine the
list of media files to apply organization to, and also to determine if the
library is a good candidate for \textit{Organization}.

\swrequirement{Organization}
The Software shall organize all media files in the library based on the
organizational scheme that pertains to the media type specified on the command
line. This organizational scheme is subject to change, as specified in
\hyperlink{sec:axesOfChange}{Axes Of Change}.

\swrequirement{Logging}
The Software shall perform logging to both a file and the stdout/stderr file
descriptors. The Software shall specify three levels of log messages, listed
in order of increasing severity:
\begin{enumerate}
\item \texttt{INFO}: Messages that occur during the normal operation of the
  Software.
\item \texttt{WARNING}: Messages that occur as a result of a condition that
  indicates a potentially unstable context, but does not immediately result
  in an \textit{Error State}.
\item \texttt{ERROR}: Messages that occur because the Software has entered an
  \textit{Error State}.
\end{enumerate}
The Software shall perform message logging (by default) as follows:
\begin{enumerate}
\item \texttt{INFO} messages shall be fed to the stdout file descriptor.
\item \texttt{WARNING} and \texttt{ERROR} messages shall be fed to the stderr
  file descriptor.
\item If the Software has successfully completed the \textit{Initialization}
  phase and has entered the \textit{Organization} phase, \texttt{WARNING} and
  \texttt{ERROR} messages shall be fed to a file with the name
  \texttt{SortMedia.log} in the parent directory of the root directory of the
  library. If a file with this name already exists in that directory, the
  Software shall append new messages to the end of the file. If the parent
  directory of the root directory of the library does not exist, the Software
  shall create a log message and place the log file in the root directory of
  the library.
\end{enumerate}

\swrequirement{Error Handling}
During abnormal operation of the Software, the Software may enter an
\textit{Error State}. There are two kinds of \textit{Error States}.
\begin{enumerate}
\item \textit{Fatal Error}: Results in the termination of the program. This
  state occurs as a result of an unrecoverable condition that was encountered
  during the operation of the Software.
\item \textit{Non-Fatal Error}: Usually occurs as a result of a failure while
  applying a single atomic change to a Media File. Causes the Software to
  revert all previous modifications to the Media File.
\end{enumerate}
\end{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
